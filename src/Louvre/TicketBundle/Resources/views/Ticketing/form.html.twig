<div class="well well-lg ">
  {{ form_start(form, {'attr': {'class': 'form-horizontal'}}) }}
  {{ form_errors(form) }}
    <div class="panel panel-primary">
      <div class="panel-heading">
        <h3 class="panel-title">Choississez une date</h3>
      </div>
      <div class="panel-body">
        <div class="form-group">
          <div class="col-md-5"></div>
            <div class="col-md-2">
                {{ form_widget(form.datevisit, {'attr' : {'class':'form-control datepicker'}}) }}
                {{ form_errors(form.datevisit)}}
            </div>
         </div>
      </div>
    </div>

    <div class="panel panel-primary">
      <div class="panel-heading">
        <h3 class="panel-title">Sélectionnez votre Billet</h3>
      </div>
         <div class="panel-body">
             {{ form_widget(form.ticketype) }}  
             {{ form_errors(form.ticketype)}}    
         </div>
    </div>
 
    <div class="panel panel-primary">
     <div class="panel-heading">
       <h3 class="panel-title">Remplissez vos infos</h3>
     </div>
     <div class="informations">

       {% form_theme form.tickets 'LouvreTicketBundle:Forms:test.html.twig' %}
       {{ form_widget(form.tickets) }}
        
       <br>
       <a href="#" id="add_ticket" class="btn btn-default">Ajouter un billet</a>
       <br>
       
     </div>
    </div>
  

    <div class="panel panel-primary">
          <div class="panel-heading">
            <h3 class="panel-title">Rentrez votre email</h3>
          </div>
          <div class="panel-body">             
            <div class="form-group">
                 {{ form_label(form.mail, "Mail", {'label_attr': {'class': 'col-sm-1 control-label'}}) }}                 
              <div class="col-md-4">
                  {{ form_widget(form.mail,{'attr' : { 'class': 'form-control'}}) }}
                  {{ form_errors(form.mail) }}
              </div>
            </div>
        </div>
    </div>
 

    <div class="row">
          {{ form_widget(form.save, {'label': 'Etape suivante'}) }}
    </div>

  {{ form_rest(form) }}
  {{ form_end(form) }}

</div>

<script type="text/javascript">
  $(document).ready(function() {

    var holidays = ["01-05","01-11","25-12"]
    
    var options = {
          minDate: -0,
          changeMonth: true,
          changeYear: true,
          yearRange: "1940:2020",
          altField: "#datepicker",
          closeText: 'Fermer',
          prevText: 'Précédent',
          nextText: 'Suivant',
          currentText: 'Aujourd\'hui',
          monthNames: ['Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'Août', 'Septembre', 'Octobre', 'Novembre', 'Décembre'],
          monthNamesShort: ['Janv.', 'Févr.', 'Mars', 'Avril', 'Mai', 'Juin', 'Juil.', 'Août', 'Sept.', 'Oct.', 'Nov.', 'Déc.'],
          dayNames: ['Dimanche', 'Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi'],
          dayNamesShort: ['Dim.', 'Lun.', 'Mar.', 'Mer.', 'Jeu.', 'Ven.', 'Sam.'],
          dayNamesMin: ['Dim', 'Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam'],
          weekHeader: 'Sem.',
          dateFormat: 'dd/mm/yy',
          beforeShowDay: function(date){
            var day = date.getDay();
            var string = jQuery.datepicker.formatDate('dd-mm', date);
            return [ holidays.indexOf(string) == -1 && day != 0 && day != 2]
           }
          };
    


    $(function() {
      $( ".datepicker" ).datepicker(options);
      options.minDate = null;
      options.beforeShowDay = null;
      $( ".datepicker2" ).datepicker(options);
      });


    $(":checkbox").change(function(e) {
        if (this.checked) {
            $("#aide").show();
        } else {
            $("#aide").hide();
        }
    });

  


    var $container = $('div#louvre_ticketbundle_globalticket_tickets');
    var index = $container.find(':input').length;
    

    $('#add_ticket').click(function(e) {
      addTicket($container);   
      
      
      $( ".datepicker2" ).datepicker(options);

      e.preventDefault(); 
      return false;
    });

    // On ajoute un premier champ automatiquement
    if (index == 0) {
      addTicket($container);
    } else {
      $container.children('div').each(function() {
        addDeleteLink($(this));
      });
    }

    // La fonction qui ajoute un ticket
    function addTicket($container) {
      var template = $container.attr('data-prototype')
        .replace(/__name__label__/g, 'Billet n°' + (index+1))
        .replace(/__name__/g,        index)
      ;
      var $prototype = $(template);
      addDeleteLink($prototype);
      $container.append($prototype);
      index++;
    }

    // La fonction qui ajoute un lien de suppression
    function addDeleteLink($prototype) {
      var $deleteLink = $("<a href='#'' class='btn btn-danger'>Supprimer</a>");
      $prototype.append($deleteLink);
      $deleteLink.click(function(e) {
        $prototype.remove();
        e.preventDefault(); // évite qu'un # apparaisse dans l'URL
        return false;
      });
    }
  });
</script>
